"use strict";(()=>{var e={};e.id=679,e.ids=[679],e.modules={8013:e=>{e.exports=require("mongodb")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},9389:(e,r,t)=>{t.r(r),t.d(r,{config:()=>p,default:()=>g,routeModule:()=>m});var n={};t.r(n),t.d(n,{default:()=>f});var o=t(1802),i=t(7153),a=t(6249);let{findAdminWithPassword:s}=t(5410),{setAuthCookie:u,clearAuthCookie:l}=t(9800),{logActivity:d,getClientIP:c}=t(4090);async function f(e,r){if("POST"!==e.method)return r.status(405).json({error:"Method not allowed"});let{username:t,password:n}=e.body;if(!t||!n)return console.log("❌ Missing username or password"),d("Admin login failed",{username:t||"missing",reason:"missing_credentials",ip:e.ip}),l(r),r.status(400).json({error:"Username and password are required"});try{if(!await s(t,n))return console.log("❌ Invalid credentials for user:",t),d("Admin login failed",{username:t,reason:"invalid_credentials",ip:c(e)}),l(r),r.status(401).json({error:"Invalid username or password"});return u(r,{username:t,adminLoggedIn:!0}),d("Admin login successful",{username:t}),r.json({success:!0,user:{username:t}})}catch(e){return console.error("❌ Login error:",e),d("Admin login error",{error:e.message,username:t}),r.status(500).json({error:"Login failed",details:e.message})}}let g=(0,a.l)(n,"default"),p=(0,a.l)(n,"config"),m=new o.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/admin/login",pathname:"/api/admin/login",bundlePath:"",filename:""},userland:n})},9800:(e,r,t)=>{let n=t(6113),o=process.env.SESSION_SECRET||"your-secret-key-change-this";function i(e){let r=Date.now(),t={...e,iat:r,exp:r+864e5},i=Buffer.from(JSON.stringify({alg:"HS256",typ:"JWT"})).toString("base64url"),a=Buffer.from(JSON.stringify(t)).toString("base64url"),s=n.createHmac("sha256",o).update(`${i}.${a}`).digest("base64url");return`${i}.${a}.${s}`}function a(e){try{if(!e)return null;let[r,t,i]=e.split("."),a=n.createHmac("sha256",o).update(`${r}.${t}`).digest("base64url");if(i!==a)return console.log("❌ JWT signature verification failed"),null;let s=JSON.parse(Buffer.from(t,"base64url").toString());if(s.exp<Date.now())return console.log("❌ JWT token expired"),null;return s}catch(e){return console.error("❌ JWT verification error:",e),null}}function s(e){let r=e.headers.cookie;if(r){let e=r.match(/auth-token=([^;]+)/);if(e)return e[1]}return null}e.exports={createToken:i,verifyToken:a,setAuthCookie:function(e,r){let t=i(r);e.setHeader("Set-Cookie",[`auth-token=${t}; HttpOnly; Path=/; Max-Age=86400; SameSite=Lax`])},clearAuthCookie:function(e){e.setHeader("Set-Cookie",["auth-token=; HttpOnly; Path=/; Max-Age=0; SameSite=Lax"])},getTokenFromRequest:s,requireAuth:function(e){return a(s(e))||(console.log("❌ Authentication required"),null)}}},4090:(e,r,t)=>{let n=t(6113);e.exports={generateProxyId:function(){return n.randomBytes(8).toString("hex")},isValidUrl:function(e){try{let r=new URL(e);return"http:"===r.protocol||"https:"===r.protocol}catch(e){return!1}},sanitizeInput:function(e){return e&&"string"==typeof e?e.trim().replace(/[<>]/g,""):""},logActivity:function(e,r={}){let t=new Date().toISOString();console.log(`[${t}] ${e}:`,r)},generateFingerprint:function(){return n.randomBytes(16).toString("hex")},getClientIP:function(e){return e.headers["x-forwarded-for"]||e.headers["x-real-ip"]||e.connection?.remoteAddress||"unknown"}}}};var r=require("../../../webpack-api-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[869],()=>t(9389));module.exports=n})();