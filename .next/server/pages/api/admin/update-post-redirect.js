"use strict";(()=>{var e={};e.id=827,e.ids=[827],e.modules={8013:e=>{e.exports=require("mongodb")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},7978:(e,t,r)=>{r.r(t),r.d(t,{config:()=>f,default:()=>c,routeModule:()=>p});var o={};r.r(o),r.d(o,{default:()=>d});var n=r(1802),i=r(7153),a=r(6249);let{requireAuth:u}=r(9800),{updatePostExperimentRedirectUrl:s,getProxyLink:l}=r(5410);async function d(e,t){if(!u(e))return t.status(401).json({error:"Unauthorized"});if("POST"!==e.method)return t.status(405).json({error:"Method not allowed"});let{proxyId:r,postExperimentRedirectUrl:o}=e.body;if(!r)return t.status(400).json({error:"Proxy ID is required"});if(!o)return t.status(400).json({error:"Post-experiment redirect URL is required"});try{new URL(o)}catch(e){return t.status(400).json({error:"Invalid URL format"})}try{if(!await l(r))return t.status(404).json({error:"Proxy link not found"});await s(r,o),t.status(200).json({success:!0,message:"Post-experiment redirect URL updated successfully",proxyId:r,postExperimentRedirectUrl:o})}catch(e){console.error("Error updating post-experiment redirect URL:",e),t.status(500).json({error:"Failed to update redirect URL"})}}let c=(0,a.l)(o,"default"),f=(0,a.l)(o,"config"),p=new n.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/admin/update-post-redirect",pathname:"/api/admin/update-post-redirect",bundlePath:"",filename:""},userland:o})},9800:(e,t,r)=>{let o=r(6113),n=process.env.SESSION_SECRET||"your-secret-key-change-this";function i(e){let t=Date.now(),r={...e,iat:t,exp:t+864e5},i=Buffer.from(JSON.stringify({alg:"HS256",typ:"JWT"})).toString("base64url"),a=Buffer.from(JSON.stringify(r)).toString("base64url"),u=o.createHmac("sha256",n).update(`${i}.${a}`).digest("base64url");return`${i}.${a}.${u}`}function a(e){try{if(!e)return null;let[t,r,i]=e.split("."),a=o.createHmac("sha256",n).update(`${t}.${r}`).digest("base64url");if(i!==a)return console.log("❌ JWT signature verification failed"),null;let u=JSON.parse(Buffer.from(r,"base64url").toString());if(u.exp<Date.now())return console.log("❌ JWT token expired"),null;return u}catch(e){return console.error("❌ JWT verification error:",e),null}}function u(e){let t=e.headers.cookie;if(t){let e=t.match(/auth-token=([^;]+)/);if(e)return e[1]}return null}e.exports={createToken:i,verifyToken:a,setAuthCookie:function(e,t){let r=i(t);e.setHeader("Set-Cookie",[`auth-token=${r}; HttpOnly; Path=/; Max-Age=86400; SameSite=Lax`])},clearAuthCookie:function(e){e.setHeader("Set-Cookie",["auth-token=; HttpOnly; Path=/; Max-Age=0; SameSite=Lax"])},getTokenFromRequest:u,requireAuth:function(e){return a(u(e))||(console.log("❌ Authentication required"),null)}}}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[869],()=>r(7978));module.exports=o})();