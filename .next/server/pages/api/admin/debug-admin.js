"use strict";(()=>{var e={};e.id=158,e.ids=[158],e.modules={8013:e=>{e.exports=require("mongodb")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},8056:(e,t,r)=>{r.r(t),r.d(t,{config:()=>c,default:()=>d,routeModule:()=>f});var a={};r.r(a),r.d(a,{default:()=>s});var n=r(1802),o=r(7153),i=r(6249);let{getAllAdmins:u}=r(5410),{getTokenFromRequest:l}=r(9800);async function s(e,t){if("GET"!==e.method)return t.status(405).json({error:"Method not allowed"});try{let r=await u();console.log("\uD83D\uDD0D All admins in database:",r);let a=r.find(e=>"admin"===e.username);t.json({adminExists:!!a,adminData:a?{username:a.username,created_at:a.created_at}:null,authToken:!!l(e),allAdmins:r.map(e=>({username:e.username,created_at:e.created_at}))})}catch(e){console.error("\uD83D\uDD0D Debug admin error:",e),t.json({error:e.message,stack:e.stack})}}let d=(0,i.l)(a,"default"),c=(0,i.l)(a,"config"),f=new n.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/admin/debug-admin",pathname:"/api/admin/debug-admin",bundlePath:"",filename:""},userland:a})},9800:(e,t,r)=>{let a=r(6113),n=process.env.SESSION_SECRET||"your-secret-key-change-this";function o(e){let t=Date.now(),r={...e,iat:t,exp:t+864e5},o=Buffer.from(JSON.stringify({alg:"HS256",typ:"JWT"})).toString("base64url"),i=Buffer.from(JSON.stringify(r)).toString("base64url"),u=a.createHmac("sha256",n).update(`${o}.${i}`).digest("base64url");return`${o}.${i}.${u}`}function i(e){try{if(!e)return null;let[t,r,o]=e.split("."),i=a.createHmac("sha256",n).update(`${t}.${r}`).digest("base64url");if(o!==i)return console.log("❌ JWT signature verification failed"),null;let u=JSON.parse(Buffer.from(r,"base64url").toString());if(u.exp<Date.now())return console.log("❌ JWT token expired"),null;return u}catch(e){return console.error("❌ JWT verification error:",e),null}}function u(e){let t=e.headers.cookie;if(t){let e=t.match(/auth-token=([^;]+)/);if(e)return e[1]}return null}e.exports={createToken:o,verifyToken:i,setAuthCookie:function(e,t){let r=o(t);e.setHeader("Set-Cookie",[`auth-token=${r}; HttpOnly; Path=/; Max-Age=86400; SameSite=Lax`])},clearAuthCookie:function(e){e.setHeader("Set-Cookie",["auth-token=; HttpOnly; Path=/; Max-Age=0; SameSite=Lax"])},getTokenFromRequest:u,requireAuth:function(e){return i(u(e))||(console.log("❌ Authentication required"),null)}}}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[869],()=>r(8056));module.exports=a})();