"use strict";(()=>{var e={};e.id=962,e.ids=[962],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,o){return o in t?t[o]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,o)):"function"==typeof t&&"default"===o?t:void 0}}})},5275:(e,t,o)=>{o.r(t),o.d(t,{config:()=>f,default:()=>c,routeModule:()=>d});var r={};o.r(r),o.d(r,{default:()=>s});var n=o(1802),u=o(7153),i=o(6249);let{getTokenFromRequest:l,verifyToken:a}=o(9800);function s(e,t){if("GET"!==e.method)return t.status(405).json({error:"Method not allowed"});console.log("\uD83D\uDD0D Check auth called");let o=l(e);console.log("\uD83D\uDD0D Auth token exists:",!!o);let r=a(o),n=!!r;console.log("\uD83D\uDD0D User verified:",!!r),console.log("\uD83D\uDD0D Is logged in:",n),t.json({isLoggedIn:n,user:r?{username:r.username}:null})}let c=(0,i.l)(r,"default"),f=(0,i.l)(r,"config"),d=new n.PagesAPIRouteModule({definition:{kind:u.x.PAGES_API,page:"/api/admin/check-auth",pathname:"/api/admin/check-auth",bundlePath:"",filename:""},userland:r})},9800:(e,t,o)=>{let r=o(6113),n=process.env.SESSION_SECRET||"your-secret-key-change-this";function u(e){let t=Date.now(),o={...e,iat:t,exp:t+864e5},u=Buffer.from(JSON.stringify({alg:"HS256",typ:"JWT"})).toString("base64url"),i=Buffer.from(JSON.stringify(o)).toString("base64url"),l=r.createHmac("sha256",n).update(`${u}.${i}`).digest("base64url");return`${u}.${i}.${l}`}function i(e){try{if(!e)return null;let[t,o,u]=e.split("."),i=r.createHmac("sha256",n).update(`${t}.${o}`).digest("base64url");if(u!==i)return console.log("❌ JWT signature verification failed"),null;let l=JSON.parse(Buffer.from(o,"base64url").toString());if(l.exp<Date.now())return console.log("❌ JWT token expired"),null;return console.log("✅ JWT token verified:",l),l}catch(e){return console.error("❌ JWT verification error:",e),null}}function l(e){let t=e.headers.cookie;if(t){let e=t.match(/auth-token=([^;]+)/);if(e)return e[1]}return null}e.exports={createToken:u,verifyToken:i,setAuthCookie:function(e,t){console.log("\uD83D\uDD0D Setting auth cookie for user:",t.username);let o=u(t);e.setHeader("Set-Cookie",[`auth-token=${o}; HttpOnly; Path=/; Max-Age=86400; SameSite=Lax`]),console.log("✅ Auth cookie set for user:",t.username)},clearAuthCookie:function(e){e.setHeader("Set-Cookie",["auth-token=; HttpOnly; Path=/; Max-Age=0; SameSite=Lax"]),console.log("✅ Auth cookie cleared")},getTokenFromRequest:l,requireAuth:function(e){let t=i(l(e));return t?(console.log("✅ User authenticated:",t.username),t):(console.log("❌ Authentication required"),null)}}},7153:(e,t)=>{var o;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return o}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(o||(o={}))},1802:(e,t,o)=>{e.exports=o(145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var o=t(t.s=5275);module.exports=o})();