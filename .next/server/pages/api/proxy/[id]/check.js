"use strict";(()=>{var e={};e.id=813,e.ids=[813],e.modules={8013:e=>{e.exports=require("mongodb")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},1856:(e,r,t)=>{t.r(r),t.d(r,{config:()=>l,default:()=>d,routeModule:()=>p});var n={};t.r(n),t.d(n,{default:()=>u});var o=t(1802),i=t(7153),a=t(6249);let{getActiveProxyLink:s}=t(5410),{logActivity:c}=t(4090);async function u(e,r){if("POST"!==e.method)return r.status(405).json({error:"Method not allowed"});let{id:t}=e.query;try{let e=await s(t);if(!e)return r.status(404).json({error:"Link not found or inactive",canAccess:!1});return c("Legacy API accessed - redirecting to waiting room",{proxyId:t}),r.json({canAccess:!1,message:"This experiment now uses a waiting room system. Please refresh the page.",useWaitingRoom:!0,maxParticipants:e.max_uses})}catch(e){return console.error("âŒ Legacy proxy check error:",e),r.status(500).json({error:"Internal server error"})}}let d=(0,a.l)(n,"default"),l=(0,a.l)(n,"config"),p=new o.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/proxy/[id]/check",pathname:"/api/proxy/[id]/check",bundlePath:"",filename:""},userland:n})},4090:(e,r,t)=>{let n=t(6113);e.exports={generateProxyId:function(){return n.randomBytes(8).toString("hex")},isValidUrl:function(e){try{let r=new URL(e);return"http:"===r.protocol||"https:"===r.protocol}catch(e){return!1}},sanitizeInput:function(e){return e&&"string"==typeof e?e.trim().replace(/[<>]/g,""):""},logActivity:function(e,r={}){let t=new Date().toISOString();console.log(`[${t}] ${e}:`,r)},generateFingerprint:function(){return n.randomBytes(16).toString("hex")},getClientIP:function(e){return e.headers["x-forwarded-for"]||e.headers["x-real-ip"]||e.connection?.remoteAddress||"unknown"}}}};var r=require("../../../../webpack-api-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[869],()=>t(1856));module.exports=n})();