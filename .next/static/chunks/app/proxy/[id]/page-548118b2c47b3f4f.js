(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[330],{3711:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});let n=(0,t(5531).Z)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},3715:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});let n=(0,t(5531).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},4900:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});let n=(0,t(5531).Z)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])},2527:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});let n=(0,t(5531).Z)("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},3181:function(e,r,t){Promise.resolve().then(t.bind(t,6583))},6583:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return C}});var n=t(7437),a=t(2265),s=t(4033),i=t(5754),o=t(7815),c=t(1478),l=t(7929),d=t(8338),u=t(5674),m=t(5750),x=t(3715),p=t(4900),f=t(4631),g=t(3711);function h(e){let{link:r,remainingSpots:t,proxyId:s,onJoinSuccess:h}=e,[b,v]=(0,a.useState)(!1),{showToast:y}=(0,d.useToast)(),w=()=>{let e=document.createElement("canvas"),r=e.getContext("2d");r&&(r.textBaseline="top",r.font="14px Arial",r.fillText("Browser fingerprint",2,2));let t=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,screen.colorDepth,new Date().getTimezoneOffset(),!!window.sessionStorage,!!window.localStorage,e.toDataURL(),navigator.hardwareConcurrency||"unknown",navigator.platform],n=0,a=t.join("|");for(let e=0;e<a.length;e++)n=(n<<5)-n+a.charCodeAt(e),n&=n;return Math.abs(n).toString(36)},j=async()=>{v(!0);try{let e=w(),t=await fetch("/api/proxy/".concat(s,"/use"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fingerprint:e})}),n=await t.json();if(n.success){let t="study_group_".concat(s,"_fp"),n="study_access_".concat(s),a=new Date;a.setDate(a.getDate()+30),document.cookie="".concat(t,"=").concat(e,"; expires=").concat(a.toUTCString(),"; path=/"),localStorage.setItem(n,e),y("success","Success!","Successfully joined! Opening experiment..."),window.open(r.real_url,"_blank"),setTimeout(()=>{h()},1e3)}else throw Error(n.error||"Failed to join experiment")}catch(e){console.error("Error joining experiment:",e),y("error","Error","Failed to join experiment. Please try again.")}finally{v(!1)}};return(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 via-background to-accent-50 flex items-center justify-center p-4",children:(0,n.jsx)("div",{className:"w-full max-w-2xl",children:(0,n.jsxs)(o.Zb,{className:"border-0 shadow-2xl bg-white/95 backdrop-blur-sm",children:[(0,n.jsxs)(o.Ol,{className:"text-center space-y-4 pb-8",children:[(0,n.jsx)("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-gradient-to-r from-primary-600 to-accent-600",children:(0,n.jsx)(u.Z,{className:"h-8 w-8 text-white"})}),(0,n.jsxs)(c.C,{variant:"outline",className:"mx-auto px-4 py-2 border-primary-200 bg-primary-50 text-primary-700",children:[(0,n.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),r.group_name||"Experiment Group"]}),(0,n.jsx)(o.ll,{className:"text-3xl font-bold text-gray-900",children:"Welcome to the Research Experiment"}),(0,n.jsx)(o.SZ,{className:"text-lg text-gray-600",children:"Click the button below to join your assigned experiment session"})]}),(0,n.jsxs)(o.aY,{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsx)(o.Zb,{className:"border-0 bg-gradient-to-br from-success-50 to-success-100",children:(0,n.jsxs)(o.aY,{className:"pt-6 text-center",children:[(0,n.jsx)("div",{className:"text-3xl font-bold text-success-600 mb-2",children:t}),(0,n.jsx)("div",{className:"text-sm text-success-700/70",children:"Spots Remaining"})]})}),(0,n.jsx)(o.Zb,{className:"border-0 bg-gradient-to-br from-primary-50 to-primary-100",children:(0,n.jsxs)(o.aY,{className:"pt-6 text-center",children:[(0,n.jsx)("div",{className:"text-3xl font-bold text-primary-600 mb-2",children:r.max_uses}),(0,n.jsx)("div",{className:"text-sm text-primary-700/70",children:"Total Participants"})]})})]}),(0,n.jsx)(i.z,{onClick:j,disabled:b,size:"lg",className:"w-full h-14 text-lg bg-gradient-to-r from-success-600 to-success-700 hover:from-success-700 hover:to-success-800",children:b?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.Z,{className:"mr-2 h-5 w-5 animate-spin"}),"Joining..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Z,{className:"mr-2 h-5 w-5"}),"Join Experiment"]})}),(0,n.jsxs)(l.bZ,{className:"border-warning-200 bg-warning-50",children:[(0,n.jsx)(f.Z,{className:"h-4 w-4 text-warning-600"}),(0,n.jsxs)(l.X,{className:"text-warning-800",children:[(0,n.jsx)("strong",{children:"Important:"})," You can only join once. ",t," spots remaining in this group. The experiment will open in a new tab."]})]}),(0,n.jsx)(o.Zb,{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-0",children:(0,n.jsx)(o.aY,{className:"pt-4",children:(0,n.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,n.jsx)(g.Z,{className:"h-4 w-4 flex-shrink-0 text-primary-600"}),(0,n.jsxs)("span",{className:"font-mono break-all",children:["Destination: ",r.real_url]})]})})})]})]})})})}var b=t(4530),v=t(9806),y=t(2527);let w=(0,t(5531).Z)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]);var j=t(1396),N=t.n(j);function k(e){let{error:r,errorType:t,link:a,usage:s}=e,d=(()=>{switch(t){case"not_found":return{title:"Link Not Found",description:"The requested experiment link does not exist or has been deactivated.",icon:f.Z,variant:"destructive"};case"full":return{title:"Experiment Full",description:"This experiment group is already full. All ".concat((null==a?void 0:a.max_uses)||0," participants have joined."),icon:m.Z,variant:"default"};case"already_participated":return{title:"Already Participated",description:"You have already joined this experiment group.",icon:b.Z,variant:"default"};case"inactive":return{title:"Experiment Inactive",description:"This experiment is currently inactive. Please contact the administrator.",icon:v.Z,variant:"secondary"};default:return{title:"Error",description:r,icon:f.Z,variant:"destructive"}}})(),u=d.icon;return(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-error-50 via-background to-warning-50 flex items-center justify-center p-4",children:(0,n.jsx)("div",{className:"w-full max-w-lg",children:(0,n.jsxs)(o.Zb,{className:"border-0 shadow-2xl bg-white/95 backdrop-blur-sm",children:[(0,n.jsxs)(o.Ol,{className:"text-center space-y-4 pb-8",children:[(0,n.jsx)("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-gradient-to-r from-error-100 to-error-200",children:(0,n.jsx)(u,{className:"h-8 w-8 text-error-600"})}),a&&(0,n.jsxs)(c.C,{variant:"outline",className:"mx-auto px-4 py-2 border-primary-200 bg-primary-50 text-primary-700",children:[(0,n.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),a.group_name||"Experiment Group"]}),(0,n.jsx)(o.ll,{className:"text-2xl font-bold text-gray-900",children:d.title}),(0,n.jsx)(o.SZ,{className:"text-base text-gray-600",children:d.description})]}),(0,n.jsxs)(o.aY,{className:"space-y-6",children:[s&&"already_participated"===t&&(0,n.jsxs)(l.bZ,{className:"border-primary-200 bg-primary-50",children:[(0,n.jsx)(y.Z,{className:"h-4 w-4 text-primary-600"}),(0,n.jsxs)(l.X,{className:"text-primary-800",children:[(0,n.jsxs)("div",{className:"font-semibold mb-1",children:["Participant #",s.participant_number]}),(0,n.jsxs)("div",{className:"text-sm text-primary-700/70",children:["Joined on: ",new Date(s.used_at).toLocaleString()]})]})]}),"full"===t&&a&&(0,n.jsxs)(l.bZ,{className:"border-warning-200 bg-warning-50",children:[(0,n.jsx)(f.Z,{className:"h-4 w-4 text-warning-600"}),(0,n.jsx)(l.X,{className:"text-warning-800",children:"Please contact the administrator if you need access to this experiment."})]}),(0,n.jsx)(i.z,{asChild:!0,className:"w-full bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800",size:"lg",children:(0,n.jsxs)(N(),{href:"/",children:[(0,n.jsx)(w,{className:"mr-2 h-4 w-4"}),"Return Home"]})})]})]})})})}function C(){let e=(0,s.useParams)(),r=null==e?void 0:e.id,[t,i]=(0,a.useState)(null),[o,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{r&&l()},[r]);let l=async()=>{try{let e=d(),t=await fetch("/api/proxy/".concat(r,"/check"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fingerprint:e})}),n=await t.json();i(n)}catch(e){console.error("Error checking proxy status:",e),i({success:!1,error:"Network error. Please try again.",errorType:"not_found"})}finally{c(!1)}},d=()=>{let e=document.createElement("canvas"),r=e.getContext("2d");r&&(r.textBaseline="top",r.font="14px Arial",r.fillText("Browser fingerprint",2,2));let t=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,screen.colorDepth,new Date().getTimezoneOffset(),!!window.sessionStorage,!!window.localStorage,e.toDataURL(),navigator.hardwareConcurrency||"unknown",navigator.platform],n=0,a=t.join("|");for(let e=0;e<a.length;e++)n=(n<<5)-n+a.charCodeAt(e),n&=n;return Math.abs(n).toString(36)};return o?(0,n.jsx)("div",{className:"min-h-screen gradient-bg flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-white text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),(0,n.jsx)("p",{children:"Loading experiment..."})]})}):t&&t.success?(0,n.jsx)(h,{link:t.link,remainingSpots:t.remainingSpots,proxyId:r,onJoinSuccess:l}):(0,n.jsx)(k,{error:(null==t?void 0:t.error)||"Unknown error",errorType:(null==t?void 0:t.errorType)||"not_found",link:null==t?void 0:t.link,usage:null==t?void 0:t.usage})}},7929:function(e,r,t){"use strict";t.d(r,{X:function(){return l},bZ:function(){return c}});var n=t(7437),a=t(2265),s=t(6061),i=t(1657);let o=(0,s.j)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=a.forwardRef((e,r)=>{let{className:t,variant:a,...s}=e;return(0,n.jsx)("div",{ref:r,role:"alert",className:(0,i.cn)(o({variant:a}),t),...s})});c.displayName="Alert",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("h5",{ref:r,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",t),...a})}).displayName="AlertTitle";let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",t),...a})});l.displayName="AlertDescription"},1478:function(e,r,t){"use strict";t.d(r,{C:function(){return o}});var n=t(7437);t(2265);var a=t(6061),s=t(1657);let i=(0,a.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:r,variant:t,...a}=e;return(0,n.jsx)("div",{className:(0,s.cn)(i({variant:t}),r),...a})}},5754:function(e,r,t){"use strict";t.d(r,{z:function(){return l}});var n=t(7437),a=t(2265),s=t(4949),i=t(6061),o=t(1657);let c=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=a.forwardRef((e,r)=>{let{className:t,variant:a,size:i,asChild:l=!1,...d}=e,u=l?s.g7:"button";return(0,n.jsx)(u,{className:(0,o.cn)(c({variant:a,size:i,className:t})),ref:r,...d})});l.displayName="Button"},7815:function(e,r,t){"use strict";t.d(r,{Ol:function(){return o},SZ:function(){return l},Zb:function(){return i},aY:function(){return d},ll:function(){return c}});var n=t(7437),a=t(2265),s=t(1657);let i=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("rounded-xl border bg-card text-card-foreground shadow",t),...a})});i.displayName="Card";let o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",t),...a})});o.displayName="CardHeader";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("font-semibold leading-none tracking-tight",t),...a})});c.displayName="CardTitle";let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",t),...a})});l.displayName="CardDescription";let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",t),...a})});d.displayName="CardContent",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",t),...a})}).displayName="CardFooter"},8338:function(e,r,t){"use strict";t.r(r),t.d(r,{ToastProvider:function(){return f},useToast:function(){return x}});var n=t(7437),a=t(2265),s=t(2167),i=t(5251),o=t(4530),c=t(9806),l=t(4631),d=t(4056),u=t(2549);let m=(0,a.createContext)(void 0),x=()=>{let e=(0,a.useContext)(m);if(!e)throw Error("useToast must be used within a ToastProvider");return e},p={success:{icon:o.Z,bgColor:"bg-success-50 border-success-200",iconColor:"text-success-600",titleColor:"text-success-800",descColor:"text-success-700"},error:{icon:c.Z,bgColor:"bg-error-50 border-error-200",iconColor:"text-error-600",titleColor:"text-error-800",descColor:"text-error-700"},warning:{icon:l.Z,bgColor:"bg-warning-50 border-warning-200",iconColor:"text-warning-600",titleColor:"text-warning-800",descColor:"text-warning-700"},info:{icon:d.Z,bgColor:"bg-blue-50 border-blue-200",iconColor:"text-blue-600",titleColor:"text-blue-800",descColor:"text-blue-700"}},f=e=>{let{children:r}=e,[t,o]=(0,a.useState)([]),c=(0,a.useCallback)((e,r,t)=>{let n=Math.random().toString(36).substr(2,9),a={id:n,type:e,title:r,description:t};o(e=>[...e,a]),setTimeout(()=>{o(e=>e.filter(e=>e.id!==n))},5e3)},[]),l=(0,a.useCallback)(e=>{o(r=>r.filter(r=>r.id!==e))},[]);return(0,n.jsxs)(m.Provider,{value:{showToast:c},children:[r,(0,n.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:(0,n.jsx)(s.M,{children:t.map(e=>{let r=p[e.type],t=r.icon;return(0,n.jsx)(i.E.div,{initial:{opacity:0,x:300,scale:.3},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.5,transition:{duration:.2}},className:"".concat(r.bgColor," border rounded-lg p-4 shadow-lg max-w-sm min-w-[300px] backdrop-blur-sm"),children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)(t,{className:"h-5 w-5 ".concat(r.iconColor," flex-shrink-0 mt-0.5")}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("p",{className:"text-sm font-semibold ".concat(r.titleColor),children:e.title}),e.description&&(0,n.jsx)("p",{className:"text-sm mt-1 ".concat(r.descColor),children:e.description})]}),(0,n.jsx)("button",{onClick:()=>l(e.id),className:"".concat(r.iconColor," hover:opacity-70 transition-opacity flex-shrink-0"),children:(0,n.jsx)(u.Z,{className:"h-4 w-4"})})]})},e.id)})})})]})}},1657:function(e,r,t){"use strict";t.d(r,{cn:function(){return s}});var n=t(7042),a=t(4769);function s(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.m6)((0,n.W)(r))}},4033:function(e,r,t){e.exports=t(5313)}},function(e){e.O(0,[275,651,799,971,938,744],function(){return e(e.s=3181)}),_N_E=e.O()}]);