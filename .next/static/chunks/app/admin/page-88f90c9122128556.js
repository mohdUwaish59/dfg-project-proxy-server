(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{7298:function(e,t,r){Promise.resolve().then(r.bind(r,5023))},5023:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return en}});var s=r(7437),a=r(2265),n=r(5754),i=r(1657);function l(e){let{className:t,...r}=e;return(0,s.jsx)("div",{className:(0,i.cn)("animate-pulse rounded-md bg-primary/10",t),...r})}var c=r(1310),o=r(5883),d=r(7815);let m=a.forwardRef((e,t)=>{let{className:r,type:a,...n}=e;return(0,s.jsx)("input",{type:a,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...n})});m.displayName="Input";var u=r(6743);let x=(0,r(6061).j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),h=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(u.f,{ref:t,className:(0,i.cn)(x(),r),...a})});h.displayName=u.f.displayName;var p=r(7929),f=r(5589),g=r(7972),j=r(2405),b=r(3715);function y(e){let{onLoginSuccess:t}=e,[r,i]=(0,a.useState)({username:"",password:""}),[l,c]=(0,a.useState)(!1),[o,u]=(0,a.useState)(""),x=async e=>{e.preventDefault(),c(!0),u("");try{let e=await fetch("/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r)});if(e.ok)t();else{let t=await e.json();u(t.error||"Login failed")}}catch(e){u("Network error. Please try again.")}finally{c(!1)}};return(0,s.jsx)("div",{className:"flex min-h-[60vh] items-center justify-center",children:(0,s.jsxs)(d.Zb,{className:"w-full max-w-md shadow-xl border-0 bg-white/95 backdrop-blur-sm",children:[(0,s.jsxs)(d.Ol,{className:"space-y-1 text-center",children:[(0,s.jsx)("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-gradient-to-r from-primary-600 to-accent-600",children:(0,s.jsx)(f.Z,{className:"h-8 w-8 text-white"})}),(0,s.jsx)(d.ll,{className:"text-2xl font-bold text-gray-900",children:"Admin Access"}),(0,s.jsx)(d.SZ,{className:"text-gray-600",children:"Sign in to your admin account to manage experiment links"})]}),(0,s.jsx)(d.aY,{children:(0,s.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(h,{htmlFor:"username",className:"flex items-center gap-2",children:[(0,s.jsx)(g.Z,{className:"h-4 w-4"}),"Username"]}),(0,s.jsx)(m,{id:"username",type:"text",placeholder:"Enter your username",value:r.username,onChange:e=>i({...r,username:e.target.value}),required:!0,disabled:l})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(h,{htmlFor:"password",className:"flex items-center gap-2",children:[(0,s.jsx)(j.Z,{className:"h-4 w-4"}),"Password"]}),(0,s.jsx)(m,{id:"password",type:"password",placeholder:"Enter your password",value:r.password,onChange:e=>i({...r,password:e.target.value}),required:!0,disabled:l})]}),o&&(0,s.jsx)(p.bZ,{variant:"destructive",children:(0,s.jsx)(p.X,{children:o})}),(0,s.jsx)(n.z,{type:"submit",className:"w-full bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800",disabled:l,children:l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):"Sign In"})]})})]})})}var N=r(5750),v=r(6840),w=r(2527),C=r(4530);let k=[{key:"total",label:"Total Groups",icon:N.Z,description:"All experiment groups"},{key:"active",label:"Active Groups",icon:v.Z,description:"Currently accepting participants"},{key:"participants",label:"Total Participants",icon:w.Z,description:"Across all experiments"},{key:"full",label:"Completed Groups",icon:C.Z,description:"Reached capacity"}];function _(e){let{stats:t,links:r}=e,a=(null==r?void 0:r.filter(e=>e.is_active&&(e.waiting_count||0)>0).length)||0,n=(null==r?void 0:r.reduce((e,t)=>e+(t.waiting_count||0),0))||0;return(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[k.map((e,r)=>(0,s.jsxs)(d.Zb,{className:"transition-all hover:shadow-lg border-0 shadow-md bg-white/80 backdrop-blur-sm",children:[(0,s.jsxs)(d.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(d.ll,{className:"text-sm font-medium text-gray-600",children:e.label}),(0,s.jsx)("div",{className:"p-2 rounded-lg ".concat(["bg-primary-50","bg-success-50","bg-accent-50","bg-warning-50"][r%4]),children:(0,s.jsx)(e.icon,{className:"h-4 w-4 ".concat(["text-primary-600","text-success-600","text-accent-600","text-warning-600"][r%4])})})]}),(0,s.jsxs)(d.aY,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold bg-gradient-to-r ".concat(["from-primary-500 to-primary-600","from-success-500 to-success-600","from-accent-500 to-accent-600","from-warning-500 to-warning-600"][r%4]," bg-clip-text text-transparent"),children:t[e.key]}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:e.description})]})]},e.key)),n>0&&(0,s.jsxs)(d.Zb,{className:"transition-all hover:shadow-lg border-0 shadow-md bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:[(0,s.jsxs)(d.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(d.ll,{className:"text-sm font-medium text-blue-700",children:"Active Waiting Rooms"}),(0,s.jsx)("div",{className:"p-2 rounded-lg bg-blue-100",children:(0,s.jsx)(N.Z,{className:"h-4 w-4 text-blue-600 animate-pulse"})})]}),(0,s.jsxs)(d.aY,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:n}),(0,s.jsxs)("p",{className:"text-xs text-blue-600",children:[1===n?"participant":"participants"," waiting in ",a," ",1===a?"room":"rooms"]})]})]})]})}var T=r(7651),Z=r(3523),S=r(9224),R=r(2442);let E=T.fC;T.ZA;let z=T.B4,A=a.forwardRef((e,t)=>{let{className:r,children:a,...n}=e;return(0,s.jsxs)(T.xz,{ref:t,className:(0,i.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...n,children:[a,(0,s.jsx)(T.JO,{asChild:!0,children:(0,s.jsx)(Z.Z,{className:"h-4 w-4 opacity-50"})})]})});A.displayName=T.xz.displayName;let F=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(T.u_,{ref:t,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",r),...a,children:(0,s.jsx)(S.Z,{className:"h-4 w-4"})})});F.displayName=T.u_.displayName;let G=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(T.$G,{ref:t,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",r),...a,children:(0,s.jsx)(Z.Z,{className:"h-4 w-4"})})});G.displayName=T.$G.displayName;let O=a.forwardRef((e,t)=>{let{className:r,children:a,position:n="popper",...l}=e;return(0,s.jsx)(T.h_,{children:(0,s.jsxs)(T.VY,{ref:t,className:(0,i.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:n,...l,children:[(0,s.jsx)(F,{}),(0,s.jsx)(T.l_,{className:(0,i.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,s.jsx)(G,{})]})})});O.displayName=T.VY.displayName,a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(T.__,{ref:t,className:(0,i.cn)("px-2 py-1.5 text-sm font-semibold",r),...a})}).displayName=T.__.displayName;let P=a.forwardRef((e,t)=>{let{className:r,children:a,...n}=e;return(0,s.jsxs)(T.ck,{ref:t,className:(0,i.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...n,children:[(0,s.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(T.wU,{children:(0,s.jsx)(R.Z,{className:"h-4 w-4"})})}),(0,s.jsx)(T.eT,{children:a})]})});P.displayName=T.ck.displayName,a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(T.Z0,{ref:t,className:(0,i.cn)("-mx-1 my-1 h-px bg-muted",r),...a})}).displayName=T.Z0.displayName;var U=r(8338),I=r(9883),L=r(820);function M(e){let{onLinkCreated:t}=e,[r,i]=(0,a.useState)({groupName:"",realUrl:"",category:"",treatmentTitle:""}),[l,c]=(0,a.useState)(!1),{showToast:o}=(0,U.useToast)(),u=async e=>{e.preventDefault(),c(!0);try{let e=await fetch("/api/admin/create-link",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r)});if(e.ok)o("success","Success","Experiment link created successfully!"),i({groupName:"",realUrl:"",category:"",treatmentTitle:""}),t();else{let t=await e.json();o("error","Error",t.error||"Failed to create link")}}catch(e){o("error","Error","Network error. Please try again.")}finally{c(!1)}};return(0,s.jsxs)(d.Zb,{className:"shadow-lg border-0 bg-white/80 backdrop-blur-sm",children:[(0,s.jsxs)(d.Ol,{children:[(0,s.jsxs)(d.ll,{className:"flex items-center gap-2 text-gray-900",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-gradient-to-r from-primary-100 to-accent-100",children:(0,s.jsx)(I.Z,{className:"h-5 w-5 text-primary-600"})}),"Create New Experiment Link"]}),(0,s.jsx)(d.SZ,{className:"text-gray-600",children:"Generate a secure proxy link for your oTree experiment"})]}),(0,s.jsx)(d.aY,{children:(0,s.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(h,{htmlFor:"groupName",className:"flex items-center gap-2",children:[(0,s.jsx)(N.Z,{className:"h-4 w-4"}),"Group Name"]}),(0,s.jsx)(m,{id:"groupName",type:"text",placeholder:"e.g., Group-1",value:r.groupName,onChange:e=>i({...r,groupName:e.target.value}),required:!0,disabled:l})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(h,{htmlFor:"realUrl",className:"flex items-center gap-2",children:[(0,s.jsx)(L.Z,{className:"h-4 w-4"}),"oTree Experiment URL"]}),(0,s.jsx)(m,{id:"realUrl",type:"url",placeholder:"https://your-otree-server.com/room/...",value:r.realUrl,onChange:e=>i({...r,realUrl:e.target.value}),required:!0,disabled:l})]})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h,{htmlFor:"category",children:"Category"}),(0,s.jsxs)(E,{value:r.category,onValueChange:e=>i({...r,category:e}),disabled:l,children:[(0,s.jsx)(A,{children:(0,s.jsx)(z,{placeholder:"Select category"})}),(0,s.jsxs)(O,{children:[(0,s.jsx)(P,{value:"No Gender",children:"No Gender"}),(0,s.jsx)(P,{value:"All Male",children:"All Male"}),(0,s.jsx)(P,{value:"All Female",children:"All Female"}),(0,s.jsx)(P,{value:"Mixed",children:"Mixed"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h,{htmlFor:"treatmentTitle",children:"Treatment Title"}),(0,s.jsxs)(E,{value:r.treatmentTitle,onValueChange:e=>i({...r,treatmentTitle:e}),disabled:l,children:[(0,s.jsx)(A,{children:(0,s.jsx)(z,{placeholder:"Select treatment"})}),(0,s.jsxs)(O,{children:[(0,s.jsx)(P,{value:"Treatment 1: No communication – No Gender Information",children:"Treatment 1: No communication – No Gender Information"}),(0,s.jsx)(P,{value:"Treatment 2: Chat Communication – No Gender Information",children:"Treatment 2: Chat Communication – No Gender Information"}),(0,s.jsx)(P,{value:"Treatment 3: Chat Communication – Gender Information",children:"Treatment 3: Chat Communication – Gender Information"}),(0,s.jsx)(P,{value:"Treatment 4: Video Chat Communication",children:"Treatment 4: Video Chat Communication"})]})]})]})]}),(0,s.jsx)(n.z,{type:"submit",disabled:l,className:"w-full md:w-auto bg-gradient-to-r from-success-600 to-success-700 hover:from-success-700 hover:to-success-800",children:l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(I.Z,{className:"mr-2 h-4 w-4"}),"Create Link"]})})]})})]})}var V=r(1478),Y=r(500);let D=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,i.cn)("w-full caption-bottom text-sm",r),...a})})});D.displayName="Table";let J=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("thead",{ref:t,className:(0,i.cn)("[&_tr]:border-b",r),...a})});J.displayName="TableHeader";let q=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,i.cn)("[&_tr:last-child]:border-0",r),...a})});q.displayName="TableBody",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,i.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...a})}).displayName="TableFooter";let B=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("tr",{ref:t,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...a})});B.displayName="TableRow";let H=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("th",{ref:t,className:(0,i.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",r),...a})});H.displayName="TableHead";let W=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("td",{ref:t,className:(0,i.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",r),...a})});W.displayName="TableCell",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("caption",{ref:t,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",r),...a})}).displayName="TableCaption";var X=r(6224),$=r(3711),K=r(8203),Q=r(9133),ee=r(4900),et=r(5432),er=r(1138);function es(e){let{links:t,onLinkAction:r}=e,{showToast:a}=(0,U.useToast)(),i=async e=>{try{await navigator.clipboard.writeText(e),a("success","Copied!","Proxy link copied to clipboard")}catch(e){a("error","Error","Failed to copy link")}},l=async(e,t)=>{try{if((await fetch("/api/admin/toggle-link",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({proxyId:e,activate:!t})})).ok)a("success","Success","Group ".concat(t?"paused":"activated"," successfully!")),r();else throw Error("Failed to toggle link")}catch(e){a("error","Error","Failed to update group status")}},c=async e=>{if(confirm("Reset this group? This will allow 3 new participants to join."))try{if((await fetch("/api/admin/reset-usage",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({proxyId:e})})).ok)a("success","Success","Group usage reset successfully!"),r();else throw Error("Failed to reset usage")}catch(e){a("error","Error","Failed to reset group usage")}},o=async(e,t)=>{if(confirm('Are you sure you want to delete the experiment link for "'.concat(t,'"?\n\nThis action cannot be undone and will permanently remove:\n• The proxy link\n• All usage data\n• Participant records')))try{let s=await fetch("/api/admin/delete-link",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({proxyId:e})}),n=await s.json();if(n.success)a("success","Success",'Experiment link for "'.concat(t,'" deleted successfully')),r();else throw Error(n.error||"Failed to delete link")}catch(e){a("error","Error","Failed to delete experiment link")}};return 0===t.length?(0,s.jsx)(d.Zb,{className:"shadow-lg border-0 bg-white/80 backdrop-blur-sm",children:(0,s.jsxs)(d.aY,{className:"flex flex-col items-center justify-center py-16",children:[(0,s.jsx)("div",{className:"rounded-full bg-gradient-to-r from-primary-100 to-accent-100 p-4 mb-4",children:(0,s.jsx)(L.Z,{className:"h-8 w-8 text-primary-600"})}),(0,s.jsx)(d.ll,{className:"mb-2 text-gray-900",children:"No experiment links yet"}),(0,s.jsx)(d.SZ,{className:"text-gray-600",children:"Create your first experiment link using the form above."})]})}):(0,s.jsxs)(d.Zb,{className:"shadow-lg border-0 bg-white/80 backdrop-blur-sm",children:[(0,s.jsxs)(d.Ol,{children:[(0,s.jsxs)(d.ll,{className:"flex items-center gap-2 text-gray-900",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-gradient-to-r from-primary-100 to-accent-100",children:(0,s.jsx)(L.Z,{className:"h-5 w-5 text-primary-600"})}),"Experiment Links"]}),(0,s.jsx)(d.SZ,{className:"text-gray-600",children:"Manage your experiment proxy links and monitor participant activity"})]}),(0,s.jsx)(d.aY,{children:(0,s.jsx)("div",{className:"rounded-md border",children:(0,s.jsxs)(D,{children:[(0,s.jsx)(J,{children:(0,s.jsxs)(B,{children:[(0,s.jsx)(H,{children:"Group"}),(0,s.jsx)(H,{children:"Category"}),(0,s.jsx)(H,{children:"Treatment"}),(0,s.jsx)(H,{children:"Proxy Link"}),(0,s.jsx)(H,{children:"Usage"}),(0,s.jsx)(H,{children:"Status"}),(0,s.jsx)(H,{children:"Created"}),(0,s.jsx)(H,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(q,{children:t.map(e=>{var t;let r=e.current_uses+(e.waiting_count||0),a=r/e.max_uses*100,d=e.current_uses>=e.max_uses,m="used"===e.status,u=m?100:a,x=m?e.max_uses:r,h="".concat(window.location.origin,"/proxy/").concat(e.proxy_id);return(0,s.jsxs)(B,{children:[(0,s.jsx)(W,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(N.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"font-medium",children:e.group_name||"Unnamed Group"})]})}),(0,s.jsx)(W,{children:(0,s.jsx)(V.C,{variant:"outline",className:"text-xs",children:e.category||"Not Set"})}),(0,s.jsx)(W,{children:(0,s.jsx)("div",{className:"max-w-[200px]",children:(0,s.jsx)("span",{className:"text-sm text-muted-foreground truncate",title:e.treatment_title,children:e.treatment_title||"Not Set"})})}),(0,s.jsx)(W,{children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm font-mono",children:[(0,s.jsx)("span",{className:"truncate max-w-[200px]",title:h,children:h}),(0,s.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>i(h),className:"h-6 w-6 p-0",children:(0,s.jsx)(X.Z,{className:"h-3 w-3"})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[(0,s.jsx)($.Z,{className:"h-3 w-3"}),(0,s.jsx)("span",{className:"truncate max-w-[200px]",children:e.real_url})]})]})}),(0,s.jsx)(W,{children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("span",{className:"font-medium",children:[x,"/",e.max_uses]}),m?(0,s.jsx)("span",{className:"text-xs text-green-600 font-medium",children:"All participants completed"}):e.waiting_count&&e.waiting_count>0?(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.current_uses," completed, ",e.waiting_count," waiting"]}):null]}),!m&&e.is_active&&void 0!==e.waiting_count&&e.waiting_count>0&&(0,s.jsxs)(V.C,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700 border-blue-200",children:[e.waiting_count," waiting"]}),m&&(0,s.jsx)(V.C,{variant:"outline",className:"text-xs bg-green-50 text-green-700 border-green-200",children:"Completed"})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(Y.E,{value:u,className:"h-2 ".concat(m?"opacity-90":"")}),!m&&e.waiting_count&&e.waiting_count>0&&(0,s.jsx)("div",{className:"absolute top-0 left-0 h-2 bg-green-500 rounded-full transition-all",style:{width:"".concat(e.current_uses/e.max_uses*100,"%")}}),m&&(0,s.jsx)("div",{className:"absolute top-0 left-0 h-2 bg-green-500 rounded-full w-full transition-all"})]}),e.is_active&&void 0!==e.waiting_count&&e.waiting_count>0&&(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Participants in waiting room: ",null===(t=e.waiting_participants)||void 0===t?void 0:t.map(e=>"#".concat(e.participant_number)).join(", ")]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,s.jsx)("span",{children:"Completed"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,s.jsx)("span",{children:"Waiting"})]})]})]})]})}),(0,s.jsx)(W,{children:(0,s.jsx)(V.C,{variant:e.is_active?m?"default":d?"destructive":"default":"secondary",className:m?"bg-green-100 text-green-800 border-green-300":e.is_active?d?"bg-red-100 text-red-800 border-red-300":"bg-blue-100 text-blue-800 border-blue-300":"",children:e.is_active?m?"Used":d?"Full":"Active":"Inactive"})}),(0,s.jsx)(W,{children:(0,s.jsxs)("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[(0,s.jsx)(K.Z,{className:"h-3 w-3"}),new Date(e.created_at).toLocaleDateString()]})}),(0,s.jsx)(W,{className:"text-right",children:(0,s.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,s.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>i(h),className:"h-8 w-8 p-0",children:(0,s.jsx)(X.Z,{className:"h-3 w-3"})}),(0,s.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>l(e.proxy_id,e.is_active),className:"h-8 w-8 p-0",children:e.is_active?(0,s.jsx)(Q.Z,{className:"h-3 w-3"}):(0,s.jsx)(ee.Z,{className:"h-3 w-3"})}),(0,s.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>c(e.proxy_id),className:"h-8 w-8 p-0",children:(0,s.jsx)(et.Z,{className:"h-3 w-3"})}),(0,s.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>o(e.proxy_id,e.group_name||"Unnamed Group"),className:"h-8 w-8 p-0 text-destructive hover:text-destructive",children:(0,s.jsx)(er.Z,{className:"h-3 w-3"})})]})})]},e.proxy_id)})})]})})})]})}function ea(){let[e,t]=(0,a.useState)([]),[r,n]=(0,a.useState)({total:0,active:0,participants:0,full:0}),[i,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{o();let e=setInterval(()=>{o()},5e3);return()=>clearInterval(e)},[]);let o=async()=>{try{let[e,r]=await Promise.all([fetch("/api/admin/links",{credentials:"include"}),fetch("/api/admin/stats",{credentials:"include"})]);if(e.ok&&r.ok){let s=await e.json(),a=await r.json();t(s),n(a)}}catch(e){console.error("Error loading data:",e)}finally{c(!1)}};return i?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-4",children:Array.from({length:4}).map((e,t)=>(0,s.jsx)(l,{className:"h-24 w-full"},t))}),(0,s.jsx)(l,{className:"h-48 w-full"}),(0,s.jsx)(l,{className:"h-64 w-full"})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(_,{stats:r,links:e}),(0,s.jsx)(M,{onLinkCreated:()=>{o()}}),(0,s.jsx)(es,{links:e,onLinkAction:()=>{o()}})]})}function en(){let[e,t]=(0,a.useState)(null),[r,i]=(0,a.useState)(!0);(0,a.useEffect)(()=>{d()},[]);let d=async()=>{try{let e=await fetch("/api/admin/check-auth",{credentials:"include"}),r=await e.json();t(r.isLoggedIn)}catch(e){console.error("Error checking auth status:",e),t(!1)}finally{i(!1)}},m=async()=>{try{await fetch("/api/admin/logout",{method:"POST",credentials:"include"}),t(!1)}catch(e){console.error("Error logging out:",e)}};return r?(0,s.jsx)("div",{className:"min-h-screen bg-background",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(l,{className:"h-8 w-8 rounded"}),(0,s.jsx)(l,{className:"h-8 w-48"})]}),(0,s.jsx)(l,{className:"h-10 w-24"})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-4",children:Array.from({length:4}).map((e,t)=>(0,s.jsx)(l,{className:"h-24 w-full"},t))}),(0,s.jsx)(l,{className:"h-64 w-full"})]})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 via-background to-accent-50",children:[(0,s.jsx)("div",{className:"border-b bg-white/80 backdrop-blur-sm shadow-sm",children:(0,s.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-r from-primary-600 to-accent-600 text-white",children:(0,s.jsx)(c.Z,{className:"h-5 w-5"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"oTree Proxy Manager"}),(0,s.jsx)("p",{className:"text-sm text-primary-600/70",children:"Professional Link Management System"})]})]}),e&&(0,s.jsxs)(n.z,{variant:"outline",size:"sm",onClick:m,className:"gap-2 border-primary-200 text-primary-700 hover:bg-primary-50",children:[(0,s.jsx)(o.Z,{className:"h-4 w-4"}),"Sign Out"]})]})})}),(0,s.jsx)("div",{className:"container mx-auto px-4 py-8",children:e?(0,s.jsx)(ea,{}):(0,s.jsx)(y,{onLoginSuccess:()=>{t(!0)}})})]})}},7929:function(e,t,r){"use strict";r.d(t,{X:function(){return o},bZ:function(){return c}});var s=r(7437),a=r(2265),n=r(6061),i=r(1657);let l=(0,n.j)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=a.forwardRef((e,t)=>{let{className:r,variant:a,...n}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(l({variant:a}),r),...n})});c.displayName="Alert",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",r),...a})}).displayName="AlertTitle";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",r),...a})});o.displayName="AlertDescription"},1478:function(e,t,r){"use strict";r.d(t,{C:function(){return l}});var s=r(7437);r(2265);var a=r(6061),n=r(1657);let i=(0,a.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:r,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)(i({variant:r}),t),...a})}},5754:function(e,t,r){"use strict";r.d(t,{z:function(){return o}});var s=r(7437),a=r(2265),n=r(7256),i=r(6061),l=r(1657);let c=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),o=a.forwardRef((e,t)=>{let{className:r,variant:a,size:i,asChild:o=!1,...d}=e,m=o?n.g7:"button";return(0,s.jsx)(m,{className:(0,l.cn)(c({variant:a,size:i,className:r})),ref:t,...d})});o.displayName="Button"},7815:function(e,t,r){"use strict";r.d(t,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return i},aY:function(){return d},ll:function(){return c}});var s=r(7437),a=r(2265),n=r(1657);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...a})});i.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...a})});l.displayName="CardHeader";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",r),...a})});c.displayName="CardTitle";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...a})});o.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...a})});d.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter"},500:function(e,t,r){"use strict";r.d(t,{E:function(){return l}});var s=r(7437),a=r(2265),n=r(3177),i=r(1657);let l=a.forwardRef((e,t)=>{let{className:r,value:a,...l}=e;return(0,s.jsx)(n.fC,{ref:t,className:(0,i.cn)("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",r),...l,children:(0,s.jsx)(n.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})});l.displayName=n.fC.displayName},8338:function(e,t,r){"use strict";r.r(t),r.d(t,{ToastProvider:function(){return p},useToast:function(){return x}});var s=r(7437),a=r(2265),n=r(2167),i=r(5251),l=r(4530),c=r(9806),o=r(4631),d=r(4056),m=r(2549);let u=(0,a.createContext)(void 0),x=()=>{let e=(0,a.useContext)(u);if(!e)throw Error("useToast must be used within a ToastProvider");return e},h={success:{icon:l.Z,bgColor:"bg-success-50 border-success-200",iconColor:"text-success-600",titleColor:"text-success-800",descColor:"text-success-700"},error:{icon:c.Z,bgColor:"bg-error-50 border-error-200",iconColor:"text-error-600",titleColor:"text-error-800",descColor:"text-error-700"},warning:{icon:o.Z,bgColor:"bg-warning-50 border-warning-200",iconColor:"text-warning-600",titleColor:"text-warning-800",descColor:"text-warning-700"},info:{icon:d.Z,bgColor:"bg-blue-50 border-blue-200",iconColor:"text-blue-600",titleColor:"text-blue-800",descColor:"text-blue-700"}},p=e=>{let{children:t}=e,[r,l]=(0,a.useState)([]),c=(0,a.useCallback)((e,t,r)=>{let s=Math.random().toString(36).substr(2,9),a={id:s,type:e,title:t,description:r};l(e=>[...e,a]),setTimeout(()=>{l(e=>e.filter(e=>e.id!==s))},5e3)},[]),o=(0,a.useCallback)(e=>{l(t=>t.filter(t=>t.id!==e))},[]);return(0,s.jsxs)(u.Provider,{value:{showToast:c},children:[t,(0,s.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:(0,s.jsx)(n.M,{children:r.map(e=>{let t=h[e.type],r=t.icon;return(0,s.jsx)(i.E.div,{initial:{opacity:0,x:300,scale:.3},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.5,transition:{duration:.2}},className:"".concat(t.bgColor," border rounded-lg p-4 shadow-lg max-w-sm min-w-[300px] backdrop-blur-sm"),children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(r,{className:"h-5 w-5 ".concat(t.iconColor," flex-shrink-0 mt-0.5")}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-semibold ".concat(t.titleColor),children:e.title}),e.description&&(0,s.jsx)("p",{className:"text-sm mt-1 ".concat(t.descColor),children:e.description})]}),(0,s.jsx)("button",{onClick:()=>o(e.id),className:"".concat(t.iconColor," hover:opacity-70 transition-opacity flex-shrink-0"),children:(0,s.jsx)(m.Z,{className:"h-4 w-4"})})]})},e.id)})})})]})}},1657:function(e,t,r){"use strict";r.d(t,{cn:function(){return n}});var s=r(7042),a=r(4769);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,s.W)(t))}}},function(e){e.O(0,[529,267,353,971,938,744],function(){return e(e.s=7298)}),_N_E=e.O()}]);