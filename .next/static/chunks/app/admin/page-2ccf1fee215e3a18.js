(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{7298:function(e,t,s){Promise.resolve().then(s.bind(s,5023))},5023:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ec}});var r=s(7437),a=s(2265),l=s(5754),n=s(1657);function i(e){let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,n.cn)("animate-pulse rounded-md bg-primary/10",t),...s})}var c=s(1310),o=s(5883),d=s(7815);let m=a.forwardRef((e,t)=>{let{className:s,type:a,...l}=e;return(0,r.jsx)("input",{type:a,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...l})});m.displayName="Input";var u=s(6743);let x=(0,s(6061).j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),h=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(u.f,{ref:t,className:(0,n.cn)(x(),s),...a})});h.displayName=u.f.displayName;var p=s(7929),f=s(5589),g=s(7972),j=s(2405),N=s(3715);function b(e){let{onLoginSuccess:t}=e,[s,n]=(0,a.useState)({username:"",password:""}),[i,c]=(0,a.useState)(!1),[o,u]=(0,a.useState)(""),x=async e=>{e.preventDefault(),c(!0),u("");try{let e=await fetch("/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(s)});if(e.ok)t();else{let t=await e.json();u(t.error||"Login failed")}}catch(e){u("Network error. Please try again.")}finally{c(!1)}};return(0,r.jsx)("div",{className:"flex min-h-[60vh] items-center justify-center",children:(0,r.jsxs)(d.Zb,{className:"w-full max-w-md shadow-xl border-0 bg-white/95 backdrop-blur-sm",children:[(0,r.jsxs)(d.Ol,{className:"space-y-1 text-center",children:[(0,r.jsx)("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-gradient-to-r from-primary-600 to-accent-600",children:(0,r.jsx)(f.Z,{className:"h-8 w-8 text-white"})}),(0,r.jsx)(d.ll,{className:"text-2xl font-bold text-gray-900",children:"Admin Access"}),(0,r.jsx)(d.SZ,{className:"text-gray-600",children:"Sign in to your admin account to manage experiment links"})]}),(0,r.jsx)(d.aY,{children:(0,r.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(h,{htmlFor:"username",className:"flex items-center gap-2",children:[(0,r.jsx)(g.Z,{className:"h-4 w-4"}),"Username"]}),(0,r.jsx)(m,{id:"username",type:"text",placeholder:"Enter your username",value:s.username,onChange:e=>n({...s,username:e.target.value}),required:!0,disabled:i})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(h,{htmlFor:"password",className:"flex items-center gap-2",children:[(0,r.jsx)(j.Z,{className:"h-4 w-4"}),"Password"]}),(0,r.jsx)(m,{id:"password",type:"password",placeholder:"Enter your password",value:s.password,onChange:e=>n({...s,password:e.target.value}),required:!0,disabled:i})]}),o&&(0,r.jsx)(p.bZ,{variant:"destructive",children:(0,r.jsx)(p.X,{children:o})}),(0,r.jsx)(l.z,{type:"submit",className:"w-full bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800",disabled:i,children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(N.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):"Sign In"})]})})]})})}var y=s(5750),v=s(6840),w=s(2527),C=s(4530);let k=[{key:"total",label:"Total Groups",icon:y.Z,description:"All experiment groups"},{key:"active",label:"Active Groups",icon:v.Z,description:"Currently accepting participants"},{key:"participants",label:"Total Participants",icon:w.Z,description:"Across all experiments"},{key:"full",label:"Completed Groups",icon:C.Z,description:"Reached capacity"}];function _(e){let{stats:t,links:s}=e,a=(null==s?void 0:s.filter(e=>e.is_active&&(e.waiting_count||0)>0).length)||0,l=(null==s?void 0:s.reduce((e,t)=>e+(t.waiting_count||0),0))||0;return(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[k.map((e,s)=>(0,r.jsxs)(d.Zb,{className:"transition-all hover:shadow-lg border-0 shadow-md bg-white/80 backdrop-blur-sm",children:[(0,r.jsxs)(d.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(d.ll,{className:"text-sm font-medium text-gray-600",children:e.label}),(0,r.jsx)("div",{className:"p-2 rounded-lg ".concat(["bg-primary-50","bg-success-50","bg-accent-50","bg-warning-50"][s%4]),children:(0,r.jsx)(e.icon,{className:"h-4 w-4 ".concat(["text-primary-600","text-success-600","text-accent-600","text-warning-600"][s%4])})})]}),(0,r.jsxs)(d.aY,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold bg-gradient-to-r ".concat(["from-primary-500 to-primary-600","from-success-500 to-success-600","from-accent-500 to-accent-600","from-warning-500 to-warning-600"][s%4]," bg-clip-text text-transparent"),children:t[e.key]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:e.description})]})]},e.key)),l>0&&(0,r.jsxs)(d.Zb,{className:"transition-all hover:shadow-lg border-0 shadow-md bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:[(0,r.jsxs)(d.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(d.ll,{className:"text-sm font-medium text-blue-700",children:"Active Waiting Rooms"}),(0,r.jsx)("div",{className:"p-2 rounded-lg bg-blue-100",children:(0,r.jsx)(y.Z,{className:"h-4 w-4 text-blue-600 animate-pulse"})})]}),(0,r.jsxs)(d.aY,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:l}),(0,r.jsxs)("p",{className:"text-xs text-blue-600",children:[1===l?"participant":"participants"," waiting in ",a," ",1===a?"room":"rooms"]})]})]})]})}var Z=s(7651),T=s(3523),S=s(9224),R=s(2442);let A=Z.fC;Z.ZA;let z=Z.B4,E=a.forwardRef((e,t)=>{let{className:s,children:a,...l}=e;return(0,r.jsxs)(Z.xz,{ref:t,className:(0,n.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...l,children:[a,(0,r.jsx)(Z.JO,{asChild:!0,children:(0,r.jsx)(T.Z,{className:"h-4 w-4 opacity-50"})})]})});E.displayName=Z.xz.displayName;let F=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(Z.u_,{ref:t,className:(0,n.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,r.jsx)(S.Z,{className:"h-4 w-4"})})});F.displayName=Z.u_.displayName;let G=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(Z.$G,{ref:t,className:(0,n.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,r.jsx)(T.Z,{className:"h-4 w-4"})})});G.displayName=Z.$G.displayName;let O=a.forwardRef((e,t)=>{let{className:s,children:a,position:l="popper",...i}=e;return(0,r.jsx)(Z.h_,{children:(0,r.jsxs)(Z.VY,{ref:t,className:(0,n.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:l,...i,children:[(0,r.jsx)(F,{}),(0,r.jsx)(Z.l_,{className:(0,n.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,r.jsx)(G,{})]})})});O.displayName=Z.VY.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(Z.__,{ref:t,className:(0,n.cn)("px-2 py-1.5 text-sm font-semibold",s),...a})}).displayName=Z.__.displayName;let P=a.forwardRef((e,t)=>{let{className:s,children:a,...l}=e;return(0,r.jsxs)(Z.ck,{ref:t,className:(0,n.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...l,children:[(0,r.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(Z.wU,{children:(0,r.jsx)(R.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(Z.eT,{children:a})]})});P.displayName=Z.ck.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(Z.Z0,{ref:t,className:(0,n.cn)("-mx-1 my-1 h-px bg-muted",s),...a})}).displayName=Z.Z0.displayName;var L=s(8338),U=s(9883),I=s(820);function M(e){let{onLinkCreated:t}=e,[s,n]=(0,a.useState)({groupName:"",realUrl:"",category:"",treatmentTitle:""}),[i,c]=(0,a.useState)(!1),{showToast:o}=(0,L.useToast)(),u=async e=>{e.preventDefault(),c(!0);try{let e=await fetch("/api/admin/create-link",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(s)});if(e.ok)o("success","Success","Experiment link created successfully!"),n({groupName:"",realUrl:"",category:"",treatmentTitle:""}),t();else{let t=await e.json();o("error","Error",t.error||"Failed to create link")}}catch(e){o("error","Error","Network error. Please try again.")}finally{c(!1)}};return(0,r.jsxs)(d.Zb,{className:"shadow-lg border-0 bg-white/80 backdrop-blur-sm",children:[(0,r.jsxs)(d.Ol,{children:[(0,r.jsxs)(d.ll,{className:"flex items-center gap-2 text-gray-900",children:[(0,r.jsx)("div",{className:"p-2 rounded-lg bg-gradient-to-r from-primary-100 to-accent-100",children:(0,r.jsx)(U.Z,{className:"h-5 w-5 text-primary-600"})}),"Create New Experiment Link"]}),(0,r.jsx)(d.SZ,{className:"text-gray-600",children:"Generate a secure proxy link for your oTree experiment"})]}),(0,r.jsx)(d.aY,{children:(0,r.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(h,{htmlFor:"groupName",className:"flex items-center gap-2",children:[(0,r.jsx)(y.Z,{className:"h-4 w-4"}),"Group Name"]}),(0,r.jsx)(m,{id:"groupName",type:"text",placeholder:"e.g., Group-1",value:s.groupName,onChange:e=>n({...s,groupName:e.target.value}),required:!0,disabled:i})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(h,{htmlFor:"realUrl",className:"flex items-center gap-2",children:[(0,r.jsx)(I.Z,{className:"h-4 w-4"}),"oTree Experiment URL"]}),(0,r.jsx)(m,{id:"realUrl",type:"url",placeholder:"https://your-otree-server.com/room/...",value:s.realUrl,onChange:e=>n({...s,realUrl:e.target.value}),required:!0,disabled:i})]})]}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h,{htmlFor:"category",children:"Category"}),(0,r.jsxs)(A,{value:s.category,onValueChange:e=>n({...s,category:e}),disabled:i,children:[(0,r.jsx)(E,{children:(0,r.jsx)(z,{placeholder:"Select category"})}),(0,r.jsxs)(O,{children:[(0,r.jsx)(P,{value:"No Gender",children:"No Gender"}),(0,r.jsx)(P,{value:"All Male",children:"All Male"}),(0,r.jsx)(P,{value:"All Female",children:"All Female"}),(0,r.jsx)(P,{value:"Mixed",children:"Mixed"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h,{htmlFor:"treatmentTitle",children:"Treatment Title"}),(0,r.jsxs)(A,{value:s.treatmentTitle,onValueChange:e=>n({...s,treatmentTitle:e}),disabled:i,children:[(0,r.jsx)(E,{children:(0,r.jsx)(z,{placeholder:"Select treatment"})}),(0,r.jsxs)(O,{children:[(0,r.jsx)(P,{value:"Treatment 1: No communication – No Gender Information",children:"Treatment 1: No communication – No Gender Information"}),(0,r.jsx)(P,{value:"Treatment 2: Chat Communication – No Gender Information",children:"Treatment 2: Chat Communication – No Gender Information"}),(0,r.jsx)(P,{value:"Treatment 3: Chat Communication – Gender Information",children:"Treatment 3: Chat Communication – Gender Information"}),(0,r.jsx)(P,{value:"Treatment 4: Video Chat Communication",children:"Treatment 4: Video Chat Communication"})]})]})]})]}),(0,r.jsx)(l.z,{type:"submit",disabled:i,className:"w-full md:w-auto bg-gradient-to-r from-success-600 to-success-700 hover:from-success-700 hover:to-success-800",children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(N.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(U.Z,{className:"mr-2 h-4 w-4"}),"Create Link"]})})]})})]})}var V=s(1478),Y=s(500);let D=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:t,className:(0,n.cn)("w-full caption-bottom text-sm",s),...a})})});D.displayName="Table";let J=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("thead",{ref:t,className:(0,n.cn)("[&_tr]:border-b",s),...a})});J.displayName="TableHeader";let B=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tbody",{ref:t,className:(0,n.cn)("[&_tr:last-child]:border-0",s),...a})});B.displayName="TableBody",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tfoot",{ref:t,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...a})}).displayName="TableFooter";let q=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tr",{ref:t,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...a})});q.displayName="TableRow";let H=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("th",{ref:t,className:(0,n.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a})});H.displayName="TableHead";let W=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("td",{ref:t,className:(0,n.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a})});W.displayName="TableCell",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("caption",{ref:t,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",s),...a})}).displayName="TableCaption";var X=s(1827),$=s(2642),K=s(2549),Q=s(6224),ee=s(3711),et=s(8203),es=s(9133),er=s(4900),ea=s(5432),el=s(1138);function en(e){let{links:t,onLinkAction:s}=e,{showToast:n}=(0,L.useToast)(),[i,c]=(0,a.useState)(""),[o,u]=(0,a.useState)("all"),[x,h]=(0,a.useState)("all"),p=(0,a.useMemo)(()=>Array.from(new Set(t.map(e=>e.category).filter(Boolean))).sort(),[t]),f=(0,a.useMemo)(()=>Array.from(new Set(t.map(e=>e.treatment_title).filter(Boolean))).sort(),[t]),g=(0,a.useMemo)(()=>t.filter(e=>{var t,s,r;let a=""===i||(null===(t=e.group_name)||void 0===t?void 0:t.toLowerCase().includes(i.toLowerCase()))||(null===(s=e.category)||void 0===s?void 0:s.toLowerCase().includes(i.toLowerCase()))||(null===(r=e.treatment_title)||void 0===r?void 0:r.toLowerCase().includes(i.toLowerCase())),l="all"===o||e.category===o,n="all"===x||e.treatment_title===x;return a&&l&&n}),[t,i,o,x]),j=()=>{c(""),u("all"),h("all")},N=""!==i||"all"!==o||"all"!==x,b=async e=>{try{await navigator.clipboard.writeText(e),n("success","Copied!","Proxy link copied to clipboard")}catch(e){n("error","Error","Failed to copy link")}},v=async(e,t)=>{try{if((await fetch("/api/admin/toggle-link",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({proxyId:e,activate:!t})})).ok)n("success","Success","Group ".concat(t?"paused":"activated"," successfully!")),s();else throw Error("Failed to toggle link")}catch(e){n("error","Error","Failed to update group status")}},w=async e=>{if(confirm("Reset this group? This will allow 3 new participants to join."))try{if((await fetch("/api/admin/reset-usage",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({proxyId:e})})).ok)n("success","Success","Group usage reset successfully!"),s();else throw Error("Failed to reset usage")}catch(e){n("error","Error","Failed to reset group usage")}},C=async(e,t)=>{if(confirm('Are you sure you want to delete the experiment link for "'.concat(t,'"?\n\nThis action cannot be undone and will permanently remove:\n• The proxy link\n• All usage data\n• Participant records')))try{let r=await fetch("/api/admin/delete-link",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({proxyId:e})}),a=await r.json();if(a.success)n("success","Success",'Experiment link for "'.concat(t,'" deleted successfully')),s();else throw Error(a.error||"Failed to delete link")}catch(e){n("error","Error","Failed to delete experiment link")}};return 0===t.length?(0,r.jsx)(d.Zb,{className:"shadow-lg border-0 bg-white/80 backdrop-blur-sm",children:(0,r.jsxs)(d.aY,{className:"flex flex-col items-center justify-center py-16",children:[(0,r.jsx)("div",{className:"rounded-full bg-gradient-to-r from-primary-100 to-accent-100 p-4 mb-4",children:(0,r.jsx)(I.Z,{className:"h-8 w-8 text-primary-600"})}),(0,r.jsx)(d.ll,{className:"mb-2 text-gray-900",children:"No experiment links yet"}),(0,r.jsx)(d.SZ,{className:"text-gray-600",children:"Create your first experiment link using the form above."})]})}):(0,r.jsxs)(d.Zb,{className:"shadow-lg border-0 bg-white/80 backdrop-blur-sm",children:[(0,r.jsxs)(d.Ol,{children:[(0,r.jsxs)(d.ll,{className:"flex items-center gap-2 text-gray-900",children:[(0,r.jsx)("div",{className:"p-2 rounded-lg bg-gradient-to-r from-primary-100 to-accent-100",children:(0,r.jsx)(I.Z,{className:"h-5 w-5 text-primary-600"})}),"Experiment Links"]}),(0,r.jsx)(d.SZ,{className:"text-gray-600",children:"Manage your experiment proxy links and monitor participant activity"})]}),(0,r.jsxs)(d.aY,{children:[(0,r.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(X.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(m,{placeholder:"Search by group name, category, or treatment...",value:i,onChange:e=>c(e.target.value),className:"pl-10"})]}),(0,r.jsxs)(A,{value:o,onValueChange:u,children:[(0,r.jsxs)(E,{className:"w-full sm:w-[200px]",children:[(0,r.jsx)($.Z,{className:"h-4 w-4 mr-2"}),(0,r.jsx)(z,{placeholder:"All Categories"})]}),(0,r.jsxs)(O,{children:[(0,r.jsx)(P,{value:"all",children:"All Categories"}),p.map(e=>(0,r.jsx)(P,{value:e,children:e},e))]})]}),(0,r.jsxs)(A,{value:x,onValueChange:h,children:[(0,r.jsxs)(E,{className:"w-full sm:w-[250px]",children:[(0,r.jsx)($.Z,{className:"h-4 w-4 mr-2"}),(0,r.jsx)(z,{placeholder:"All Treatments"})]}),(0,r.jsxs)(O,{children:[(0,r.jsx)(P,{value:"all",children:"All Treatments"}),f.map(e=>(0,r.jsx)(P,{value:e,children:e.length>40?"".concat(e.substring(0,40),"..."):e},e))]})]}),N&&(0,r.jsxs)(l.z,{variant:"outline",onClick:j,className:"w-full sm:w-auto",children:[(0,r.jsx)(K.Z,{className:"h-4 w-4 mr-2"}),"Clear"]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[(0,r.jsxs)("span",{children:["Showing ",g.length," of ",t.length," experiment",1!==t.length?"s":""]}),N&&(0,r.jsx)(V.C,{variant:"secondary",className:"text-xs",children:"Filtered"})]})]}),(0,r.jsx)("div",{className:"rounded-md border",children:(0,r.jsxs)(D,{children:[(0,r.jsx)(J,{children:(0,r.jsxs)(q,{children:[(0,r.jsx)(H,{children:"Group"}),(0,r.jsx)(H,{children:"Category"}),(0,r.jsx)(H,{children:"Treatment"}),(0,r.jsx)(H,{children:"Proxy Link"}),(0,r.jsx)(H,{children:"Usage"}),(0,r.jsx)(H,{children:"Status"}),(0,r.jsx)(H,{children:"Created"}),(0,r.jsx)(H,{className:"text-right",children:"Actions"})]})}),(0,r.jsx)(B,{children:0===g.length?(0,r.jsx)(q,{children:(0,r.jsx)(W,{colSpan:8,className:"text-center py-8",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsx)(X.Z,{className:"h-8 w-8 text-muted-foreground"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:N?"No experiments match your search criteria":"No experiments found"}),N&&(0,r.jsx)(l.z,{variant:"outline",size:"sm",onClick:j,children:"Clear filters"})]})})}):g.map(e=>{var t;let s=e.current_uses+(e.waiting_count||0),a=s/e.max_uses*100,n=e.current_uses>=e.max_uses,i="used"===e.status,c=i?100:a,o=i?e.max_uses:s,d="".concat(window.location.origin,"/proxy/").concat(e.proxy_id);return(0,r.jsxs)(q,{children:[(0,r.jsx)(W,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(y.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"font-medium",children:e.group_name||"Unnamed Group"})]})}),(0,r.jsx)(W,{children:(0,r.jsx)(V.C,{variant:"outline",className:"text-xs",children:e.category||"Not Set"})}),(0,r.jsx)(W,{children:(0,r.jsx)("div",{className:"max-w-[200px]",children:(0,r.jsx)("span",{className:"text-sm text-muted-foreground truncate",title:e.treatment_title,children:e.treatment_title||"Not Set"})})}),(0,r.jsx)(W,{children:(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm font-mono",children:[(0,r.jsx)("span",{className:"truncate max-w-[200px]",title:d,children:d}),(0,r.jsx)(l.z,{variant:"ghost",size:"sm",onClick:()=>b(d),className:"h-6 w-6 p-0",children:(0,r.jsx)(Q.Z,{className:"h-3 w-3"})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[(0,r.jsx)(ee.Z,{className:"h-3 w-3"}),(0,r.jsx)("span",{className:"truncate max-w-[200px]",children:e.real_url})]})]})}),(0,r.jsx)(W,{children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("span",{className:"font-medium",children:[o,"/",e.max_uses]}),i?(0,r.jsx)("span",{className:"text-xs text-green-600 font-medium",children:"All participants completed"}):e.waiting_count&&e.waiting_count>0?(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.current_uses," completed, ",e.waiting_count," waiting"]}):null]}),!i&&e.is_active&&void 0!==e.waiting_count&&e.waiting_count>0&&(0,r.jsxs)(V.C,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700 border-blue-200",children:[e.waiting_count," waiting"]}),i&&(0,r.jsx)(V.C,{variant:"outline",className:"text-xs bg-green-50 text-green-700 border-green-200",children:"Completed"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(Y.E,{value:c,className:"h-2 ".concat(i?"opacity-90":"")}),!i&&e.waiting_count&&e.waiting_count>0&&(0,r.jsx)("div",{className:"absolute top-0 left-0 h-2 bg-green-500 rounded-full transition-all",style:{width:"".concat(e.current_uses/e.max_uses*100,"%")}}),i&&(0,r.jsx)("div",{className:"absolute top-0 left-0 h-2 bg-green-500 rounded-full w-full transition-all"})]}),e.is_active&&void 0!==e.waiting_count&&e.waiting_count>0&&(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Participants in waiting room: ",null===(t=e.waiting_participants)||void 0===t?void 0:t.map(e=>"#".concat(e.participant_number)).join(", ")]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,r.jsx)("span",{children:"Completed"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,r.jsx)("span",{children:"Waiting"})]})]})]})]})}),(0,r.jsx)(W,{children:(0,r.jsx)(V.C,{variant:e.is_active?i?"default":n?"destructive":"default":"secondary",className:i?"bg-green-100 text-green-800 border-green-300":e.is_active?n?"bg-red-100 text-red-800 border-red-300":"bg-blue-100 text-blue-800 border-blue-300":"",children:e.is_active?i?"Used":n?"Full":"Active":"Inactive"})}),(0,r.jsx)(W,{children:(0,r.jsxs)("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[(0,r.jsx)(et.Z,{className:"h-3 w-3"}),new Date(e.created_at).toLocaleDateString()]})}),(0,r.jsx)(W,{className:"text-right",children:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,r.jsx)(l.z,{variant:"ghost",size:"sm",onClick:()=>b(d),className:"h-8 w-8 p-0",children:(0,r.jsx)(Q.Z,{className:"h-3 w-3"})}),(0,r.jsx)(l.z,{variant:"ghost",size:"sm",onClick:()=>v(e.proxy_id,e.is_active),className:"h-8 w-8 p-0",children:e.is_active?(0,r.jsx)(es.Z,{className:"h-3 w-3"}):(0,r.jsx)(er.Z,{className:"h-3 w-3"})}),(0,r.jsx)(l.z,{variant:"ghost",size:"sm",onClick:()=>w(e.proxy_id),className:"h-8 w-8 p-0",children:(0,r.jsx)(ea.Z,{className:"h-3 w-3"})}),(0,r.jsx)(l.z,{variant:"ghost",size:"sm",onClick:()=>C(e.proxy_id,e.group_name||"Unnamed Group"),className:"h-8 w-8 p-0 text-destructive hover:text-destructive",children:(0,r.jsx)(el.Z,{className:"h-3 w-3"})})]})})]},e.proxy_id)})})]})})]})]})}function ei(){let[e,t]=(0,a.useState)([]),[s,l]=(0,a.useState)({total:0,active:0,participants:0,full:0}),[n,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{o();let e=setInterval(()=>{o()},5e3);return()=>clearInterval(e)},[]);let o=async()=>{try{let[e,s]=await Promise.all([fetch("/api/admin/links",{credentials:"include"}),fetch("/api/admin/stats",{credentials:"include"})]);if(e.ok&&s.ok){let r=await e.json(),a=await s.json();t(r),l(a)}}catch(e){console.error("Error loading data:",e)}finally{c(!1)}};return n?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"grid gap-4 md:grid-cols-4",children:Array.from({length:4}).map((e,t)=>(0,r.jsx)(i,{className:"h-24 w-full"},t))}),(0,r.jsx)(i,{className:"h-48 w-full"}),(0,r.jsx)(i,{className:"h-64 w-full"})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(_,{stats:s,links:e}),(0,r.jsx)(M,{onLinkCreated:()=>{o()}}),(0,r.jsx)(en,{links:e,onLinkAction:()=>{o()}})]})}function ec(){let[e,t]=(0,a.useState)(null),[s,n]=(0,a.useState)(!0);(0,a.useEffect)(()=>{d()},[]);let d=async()=>{try{let e=await fetch("/api/admin/check-auth",{credentials:"include"}),s=await e.json();t(s.isLoggedIn)}catch(e){console.error("Error checking auth status:",e),t(!1)}finally{n(!1)}},m=async()=>{try{await fetch("/api/admin/logout",{method:"POST",credentials:"include"}),t(!1)}catch(e){console.error("Error logging out:",e)}};return s?(0,r.jsx)("div",{className:"min-h-screen bg-background",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(i,{className:"h-8 w-8 rounded"}),(0,r.jsx)(i,{className:"h-8 w-48"})]}),(0,r.jsx)(i,{className:"h-10 w-24"})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"grid gap-4 md:grid-cols-4",children:Array.from({length:4}).map((e,t)=>(0,r.jsx)(i,{className:"h-24 w-full"},t))}),(0,r.jsx)(i,{className:"h-64 w-full"})]})]})}):(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 via-background to-accent-50",children:[(0,r.jsx)("div",{className:"border-b bg-white/80 backdrop-blur-sm shadow-sm",children:(0,r.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-r from-primary-600 to-accent-600 text-white",children:(0,r.jsx)(c.Z,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"oTree Proxy Manager"}),(0,r.jsx)("p",{className:"text-sm text-primary-600/70",children:"Professional Link Management System"})]})]}),e&&(0,r.jsxs)(l.z,{variant:"outline",size:"sm",onClick:m,className:"gap-2 border-primary-200 text-primary-700 hover:bg-primary-50",children:[(0,r.jsx)(o.Z,{className:"h-4 w-4"}),"Sign Out"]})]})})}),(0,r.jsx)("div",{className:"container mx-auto px-4 py-8",children:e?(0,r.jsx)(ei,{}):(0,r.jsx)(b,{onLoginSuccess:()=>{t(!0)}})})]})}},7929:function(e,t,s){"use strict";s.d(t,{X:function(){return o},bZ:function(){return c}});var r=s(7437),a=s(2265),l=s(6061),n=s(1657);let i=(0,l.j)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=a.forwardRef((e,t)=>{let{className:s,variant:a,...l}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,n.cn)(i({variant:a}),s),...l})});c.displayName="Alert",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h5",{ref:t,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",s),...a})}).displayName="AlertTitle";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",s),...a})});o.displayName="AlertDescription"},1478:function(e,t,s){"use strict";s.d(t,{C:function(){return i}});var r=s(7437);s(2265);var a=s(6061),l=s(1657);let n=(0,a.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:s,...a}=e;return(0,r.jsx)("div",{className:(0,l.cn)(n({variant:s}),t),...a})}},5754:function(e,t,s){"use strict";s.d(t,{z:function(){return o}});var r=s(7437),a=s(2265),l=s(7256),n=s(6061),i=s(1657);let c=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),o=a.forwardRef((e,t)=>{let{className:s,variant:a,size:n,asChild:o=!1,...d}=e,m=o?l.g7:"button";return(0,r.jsx)(m,{className:(0,i.cn)(c({variant:a,size:n,className:s})),ref:t,...d})});o.displayName="Button"},7815:function(e,t,s){"use strict";s.d(t,{Ol:function(){return i},SZ:function(){return o},Zb:function(){return n},aY:function(){return d},ll:function(){return c}});var r=s(7437),a=s(2265),l=s(1657);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("rounded-xl border bg-card text-card-foreground shadow",s),...a})});n.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...a})});i.displayName="CardHeader";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("font-semibold leading-none tracking-tight",s),...a})});c.displayName="CardTitle";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...a})});o.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",s),...a})});d.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter"},500:function(e,t,s){"use strict";s.d(t,{E:function(){return i}});var r=s(7437),a=s(2265),l=s(3177),n=s(1657);let i=a.forwardRef((e,t)=>{let{className:s,value:a,...i}=e;return(0,r.jsx)(l.fC,{ref:t,className:(0,n.cn)("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",s),...i,children:(0,r.jsx)(l.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})});i.displayName=l.fC.displayName},8338:function(e,t,s){"use strict";s.r(t),s.d(t,{ToastProvider:function(){return p},useToast:function(){return x}});var r=s(7437),a=s(2265),l=s(2167),n=s(5251),i=s(4530),c=s(9806),o=s(4631),d=s(4056),m=s(2549);let u=(0,a.createContext)(void 0),x=()=>{let e=(0,a.useContext)(u);if(!e)throw Error("useToast must be used within a ToastProvider");return e},h={success:{icon:i.Z,bgColor:"bg-success-50 border-success-200",iconColor:"text-success-600",titleColor:"text-success-800",descColor:"text-success-700"},error:{icon:c.Z,bgColor:"bg-error-50 border-error-200",iconColor:"text-error-600",titleColor:"text-error-800",descColor:"text-error-700"},warning:{icon:o.Z,bgColor:"bg-warning-50 border-warning-200",iconColor:"text-warning-600",titleColor:"text-warning-800",descColor:"text-warning-700"},info:{icon:d.Z,bgColor:"bg-blue-50 border-blue-200",iconColor:"text-blue-600",titleColor:"text-blue-800",descColor:"text-blue-700"}},p=e=>{let{children:t}=e,[s,i]=(0,a.useState)([]),c=(0,a.useCallback)((e,t,s)=>{let r=Math.random().toString(36).substr(2,9),a={id:r,type:e,title:t,description:s};i(e=>[...e,a]),setTimeout(()=>{i(e=>e.filter(e=>e.id!==r))},5e3)},[]),o=(0,a.useCallback)(e=>{i(t=>t.filter(t=>t.id!==e))},[]);return(0,r.jsxs)(u.Provider,{value:{showToast:c},children:[t,(0,r.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:(0,r.jsx)(l.M,{children:s.map(e=>{let t=h[e.type],s=t.icon;return(0,r.jsx)(n.E.div,{initial:{opacity:0,x:300,scale:.3},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.5,transition:{duration:.2}},className:"".concat(t.bgColor," border rounded-lg p-4 shadow-lg max-w-sm min-w-[300px] backdrop-blur-sm"),children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(s,{className:"h-5 w-5 ".concat(t.iconColor," flex-shrink-0 mt-0.5")}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-semibold ".concat(t.titleColor),children:e.title}),e.description&&(0,r.jsx)("p",{className:"text-sm mt-1 ".concat(t.descColor),children:e.description})]}),(0,r.jsx)("button",{onClick:()=>o(e.id),className:"".concat(t.iconColor," hover:opacity-70 transition-opacity flex-shrink-0"),children:(0,r.jsx)(m.Z,{className:"h-4 w-4"})})]})},e.id)})})})]})}},1657:function(e,t,s){"use strict";s.d(t,{cn:function(){return l}});var r=s(7042),a=s(4769);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,r.W)(t))}}},function(e){e.O(0,[529,267,125,971,938,744],function(){return e(e.s=7298)}),_N_E=e.O()}]);